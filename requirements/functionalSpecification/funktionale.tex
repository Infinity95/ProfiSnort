\chapter{Funktionale Anforderungen}


\newcounter{fanr}[section]
\newcommand\fano{\arabic{fanr}}
\newcommand\fa[3]{\namedlabel{fa#1}{FA#1}: & \textit{#2: } #3 \\}

\section{\gls{sppname}}
\begin{tabular}{lp{0.9\linewidth}}

\fa{10}{Erkennung fehlerhafter Pakete}{Der \gls{praeprozessor} muss fehlerhafte Pakete erkennen und diese als solche markieren können, bevor sie an das Analysetool weitergereicht werden.}

\fa{20}{Erkennen von \gls{profinet} \glspl{paket}n}{Der \gls{praeprozessor} muss \gls{profinet} \glspl{paket} erkennen können.}

\fa{30}{Dekodieren von \gls{profinet} \glspl{paket}n}{Der \gls{praeprozessor} muss die erkannten \glspl{paket} dekodieren können.}

\fa{40}{Unterscheiden der verschiedenen \gls{frameid}s}{Der \gls{praeprozessor} muss die verschiedenen von \gls{profinet} spezifizierten \gls{frameid}s unterscheiden können.}

\fa{50}{Output Kanal zu \gls{programname}}{Es muss eine \gls{interprocess} für die Weitergabe der dekodierten Daten möglich sein.}

\fa{70}{Ausgabeschnittstelle}{\gls{sppname} muss eine einheitliche Schnittstelle zum Übertragen der Daten an \gls{programname} verwenden. Diese Schnittstelle muss prinzipiell auf andere Protokolle erweiterbar sein.}

\end{tabular}

\section{\gls{programname}}
\subsection{Funktionalität}

\begin{longtable}{lp{0.9\linewidth}}

\fa{90}{Starten von \gls{snort}}{Wenn \gls{snort} noch nicht läuft, wird der Nutzer gefragt, ob \gls{snort} gestartet werden soll.}

\fa{100}{\gls{sppname} anschalten}{Wenn \gls{snort} nicht läuft und \gls{sppname} in der \gls{snort} Konfiguration deaktiviert ist, wird der Benutzer gefragt ob, er dieses aktivieren möchte. Falls der Benutzer \gls{sppname} nicht aktiviert, beendet sich \gls{programname}.}

\fa{110}{\gls{snort} läuft aber \gls{sppname} ist deaktiviert}{Falls \gls{snort} schon läuft aber \gls{sppname} deaktiviert ist, hat der Benutzer die Wahl, \gls{sppname} zu aktivieren oder \gls{programname} zu beenden. Falls der \gls{praeprozessor} aktiviert werden soll, wird \gls{snort} mit dem reload Befehl neu geladen.}

\fa{120}{Empfangen von Paketinformationen}{\gls{programname} muss Paketinformationen empfangen können, die dem in FA70 genannten Interface entsprechen.}

\fa{130}{Erkennen neuer Netzwerkteilnehmer}{Das Programm erkennt neue Netzwerkteilnehmer und überprüft ihre Legalität (siehe FA150).}

\fa{132}{Erkennen neuer Netzwerkkommunikation}{Das Programm erkennt aufkommende Kommunikation im betrachteten Netzwerk.}

\fa{133}{Erstellen neuer Kanten}{Wenn eine neue Kommunikation erkannt wurde, wird diese im Graphen durch eine gerichtete Kante repräsentiert, wobei die Richtung der Kante vom Sender zum Empfänger zeigt.}

\fa{135}{Erstellen neuer Knoten}{Wenn ein neuer Netzwerkteilnehmer erkannt wurde, wird dieser im Graphen durch einen neuen Knoten repräsentiert.}

\fa{140}{Erkennen von Gerätenamen}{Das Analysetool soll Gerätenamen, falls vorhanden, erkennen und dem entsprechenden Knoten hinzufügen.}

\fa{150}{Kennzeichnen illegaler Knoten}{Ein Knoten, der ein Gerät aus einem illegalen Adressraum repräsentiert oder eine unbekannte/unerwünschte/illegale Identität (nicht auf der \gls{whitelist}) hat, wird für den Benutzer auffällig gekennzeichnet.}

\fa{160}{Kennzeichnen illegaler Kanten}{Kanten, die eingehende und ausgehende Kommunikation eines illegalen Knotens repräsentieren, werden für den Benutzer auffällig gekennzeichnet.}

\fa{170}{Erkennen der Kommunikationswege}{Das Programm muss basierend auf Adressen/Gerätenamen einen Kommunikationsgraph erstellen können.}

\fa{180}{Paketaustausch Statistik}{Das Programm muss berechnen können, wie viele \glspl{paket} einzelne Knoten pro Sekunde senden bzw. empfangen. Diese Information muss in dem Fenster zur detaillierten Knotenstatistik darstellbar sein.}

\fa{190}{Gesamtzahl der Pakete}{Das Programm muss die gesamte Zahl der empfangenen und gesendeten \glspl{paket} in dem Fenster zur detaillierten Knotenstatistik darstellen können.}

\fa{220}{Zeichnen des Graphen}{Der Graph kann mittels Graphalgorithmen (z.B. Kamada-Kawai, Fruchterman-Reingold) dargestellt werden.}

\fa{250}{Kantenunterschied}{Die unterschiedlichen \gls{profinet} Protokolle werden durch Labels oder Farben voneinander unterscheidbar sein.}

\fa{260}{Logging}{Das Programm erstellt ein \gls{log} aller \glspl{paket} mit kritischen Informationen und kann dieses auf Benutzerwunsch als Textdatei ausgeben.}

\fa{270}{Spezifisches Logging}{Das Programm erstellt spezifische \glspl{log} zu einzelnen Knoten mit den von diesem Knoten gesendeten/empfangenen \glspl{paket}n.}

\fa{280}{Fehlerhafte Pakete}{Von \gls{sppname} als fehlerhaft erkannte \glspl{paket} werden mit einem \gls{fehlerflag} versehen und so in das \gls{log} übernommen.}\end{longtable}

\subsection{Optionale Funktionalität}
\begin{longtable}{lp{0.9\linewidth}}

\fa{290}{Rückverfolgung}{Der Benutzer kann den zeitlichen Ablauf grafisch zurückverfolgen (wie ein Video) und sämtliche Kommunikationswege erneut abspielen.}

\fa{300}{Kennzeichnen inaktiver Knoten}{Knoten werden nach einer im Einstellungsmenü spezifizierten Zeit als inaktiv gekennzeichnet, wenn sie in dieser Zeit keine \glspl{paket} empfangen oder gesendet haben.}

\fa{305}{Darstellung des Paketvolumens}{Das Paketvolumen einzelner Verbindungen ist im Graph visuell darstellbar. Diese Darstellung kann in den Einstellungen der Übersicht halber deaktiviert werden.}

\fa{310}{Abgrenzen gefilterter Knoten}{Alle Knoten, die nicht den Filteroptionen genügen, werden optisch vom Rest des Graphen getrennt.}

\fa{315}{Timeoutbenachrichtigung}{Wenn ein \gls{iocontroller} einen \gls{identifyrequest} sendet und ein Timeout stattfindet, wird der Benutzer grafisch darüber in Kenntnis gesetzt.}

\fa{317}{Darstellen von \gls{snort} Alerts}{Falls \gls{snort} Alerts auftreten, werden diese grafisch dargestellt.}

\end{longtable}
\pagebreak
\subsection{Datenhaltung}

\begin{longtable}{lp{0.9\linewidth}}

\fa{320}{Speichern des Datenverkehrs}{Der Datenverkehr wird in einem Datenbestand gespeichert.}

\fa{330}{Kategorisierung der Daten}{Die Daten werden nach den verschiedenen Kommunikationstypen kategorisiert.}

\fa{340}{Datenausgabe}{Auf Anforderungen des Benutzers müssen Daten ausgelesen und ausgegeben werden.}

\fa{350}{Zeitraum der Datenspeicherung}{Der Zeitraum, über den die Daten gespeichert werden sollen, kann in den Einstellungen festgelegt werden.}

\end{longtable}

\subsection{Benutzerinteraktion}

\begin{longtable}{lp{0.9\linewidth}}

\fa{360}{Speichern der Einstellungen}{Das Programm speichert nach Änderungen des Benutzers automatisch bzw. nach Klick auf den Speichern-Knopf die neuen Einstellungen.}

\fa{365}{\gls{gui}}{Es gibt eine Benutzeroberfläche, über welche der Nutzer die Möglichkeit hat mit dem Graphen und den Einstellungen zu interagieren.}

\fa{370}{Fehlerhafte Benutzereingaben}{Die Benutzereingaben im Einstellungsmenü und Filtermenü werden auf Fehler überprüft. Bei Fehlern wird der Benutzer zur neuen Eingabe aufgefordert und der vorherige Wert nicht verändert.}

\fa{375}{Einstellungsmenü}{Es gibt ein Einstellungsmenü welches durch den Benutzer über die \gls{gui} erreichbar ist.}

\fa{380}{Skalierung des Graphen}{Der Benutzer ist in der Lage über das Scrollrad die Skalierung des Graphen zu verändern.}

\fa{390}{Detaillierte Information zu Knoten}{Ein Overlay mit detaillierten Informationen wird bei Klick auf einen Knoten dargestellt.}

\fa{400}{Generelle Informationen}{In einem Overlay werden generelle Informationen über den Graph angezeigt.}

\fa{410}{Hover über einem Knoten}{Hovern erfüllt im Graph dieselben Funktionen wie klicken. Zusätzlich zum aktuell angeklickten Knoten werden zum Vergleich Informationen des aktuell gehoverten Knotens angezeigt.}

\fa{420}{\gls{blacklist}}{Der Benutzer hat die Möglichkeit, bestimmte \gls{mac}- und \gls{ip} Adressräume sowie Gerätenamen als illegal zu markieren.}

\fa{425}{\gls{whitelist}}{Der Benutzer hat die Möglichkeit, bestimmte \gls{mac}- und \gls{ip} Adressräume sowie Gerätenamen als legal zu markieren.}

\fa{427}{Whitelist/Blacklist aktivieren}{Der Benutzer kann über das Einstellungsmenü wählen, welche Listen verwendet werden sollen.}

\end{longtable}

\subsection{Optionale Benutzerinteraktion}

\begin{longtable}{lp{0.9\linewidth}}

\fa{430}{Statistiken zu Knoten}{Ein Overlay mit zeitlichen Statistiken wird bei Klick auf einen Knoten angezeigt.}

\fa{440}{Filtereinstellungen}{Die Filtereinstellungen können im Einstellungsmenü angepasst werden.}

\fa{450}{Filteroptionen}{Die Knoten können nach \gls{ip}, \gls{mac} Adresse, Netzwerkaktivität oder Gerätenamen gefiltert werden.}

\fa{460}{Filter deaktivieren/reaktivieren}{Es gibt einen Hotkey und eine Option im Filterfenster zum aktivieren oder deaktivieren von Filtern.}

\fa{470}{\gls{io-supervisor} festlegen}{Der Benutzer kann Geräte als \gls{io-supervisor} markieren.}

\fa{480}{Verbindungsrichtung}{Wenn mindestens x\% (standardmäßig 90\%, konfigurierbar) der \glspl{paket} aus einer Richtung kommen, werden Verbindungen im Graph gerichtet angezeigt.}

\fa{490}{Graphdarstellungsalgorithmen}{Die Graphdarstellungsalgorithmen können über das Einstellungsmenü ausgewählt/geändert werden.}

\fa{500}{Kategorisierung}{Einzelne Knoten können im Graph als unwichtig eingestuft werden, um diese visuell abzugrenzen.}
\end{longtable}
